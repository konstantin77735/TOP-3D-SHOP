class Slider{constructor(t,i){this.autoplay=i.autoplay,this.autoplayDirection=i.autoplayDirection||"right",this.autoplaySlideTime=i.autoplaySlideTime||4e3,this.currentSlide=i.currentSlide||0,this.slidesToShow=i.slidesToShow||1,this.dotsEnable=i.dotsEnable,this.arrowsEnable=i.arrowsEnable,this.keysEnable=i.keysEnable,this.transitionSpeed=i.speed||1e3,this.transitionType=i.animationType||"ease",this.transition=`transform ${this.transitionSpeed/1e3}s ${this.transitionType}`,this.dotsHeight=i.dotsHeight||"20px",this.dotsWidth=i.dotsWidth||"20px",this.sliderSelector=t,this.slider=document.querySelector(t),this.sliderWrapper=document.querySelector(`${t}__wrapper`),this.slides=this.sliderWrapper.children,this.isRunning=!1,this.eachSlideWidth=100/this.slides.length,this.dotsWrapperClass=`${t.slice(1)}__dots-wrapper`,this.dotClass=`${t.slice(1)}__dot`,this.dotActiveClass="active-dot",this.controlClass=`${t.slice(1)}__control`,this.nextClass=`${t.slice(1)}__next`,this.prevClass=`${t.slice(1)}__prev`,this.dots,this.direction,this.iters,this.checkCount,this.checkAutoplay;(()=>{void 0===i.arrowsEnable&&(this.arrowsEnable=!0),void 0===i.dotsEnable&&(this.dotsEnable=!0),void 0===i.keysEnable&&(this.keysEnable=!0)})();this.beforeInit(),this.init()}setTransition(t){this.sliderWrapper.style.transition=t?this.transition:"none"}updateCurrentSlideSpan(){let t=this.currentSlide+1;document.querySelector(`${this.sliderSelector}__current-slide-span`).textContent=`Показываемый слайд: ${t}`}pasteSlide(t){switch(t){case"prepend":this.sliderWrapper.prepend(this.sliderWrapper.lastElementChild);break;case"append":this.sliderWrapper.append(this.sliderWrapper.firstElementChild)}}findIters(t){this.currentSlide>t?(this.direction="prev",this.iters=this.currentSlide-t):(this.direction="next",this.iters=t-this.currentSlide)}changeSlide(t){const{y:i}=t;if(!this.isRunning){const t=()=>{this.setTransition(!0),this.sliderWrapper.style.transform=`translateX(-${this.iters*this.eachSlideWidth/this.slidesToShow}%)`},s=t=>{for(let t=this.iters;t>0;t--)this.pasteSlide("prepend"),0;this.sliderWrapper.style.transform=`translateX(-${this.iters*this.eachSlideWidth/this.slidesToShow}%)`,setTimeout(()=>{this.setTransition(!0),this.sliderWrapper.style.transform="translateX(0)"},0)};if(void 0!==i?this.findIters(i):this.iters=1,this.setTransition(!1),this.iters>1)"next"==this.direction&&t(),"prev"==this.direction&&s();else switch(this.direction){case"next":this.currentSlide<this.slides.length-1?this.currentSlide++:this.currentSlide=0,this.dotsEnable&&this.changeDots({dir:this.direction}),t();break;case"prev":s(),this.currentSlide>0?this.currentSlide--:this.currentSlide=this.slides.length-1,this.dotsEnable&&this.changeDots({dir:this.direction})}}}changeDots(t){const{target:i,dir:s}=t;if(!(i&&i.classList.contains(this.dotActiveClass)||!i&&this.isRunning)){this.isRunning=!0;for(let t=0;t<this.dots.length;t++)this.dots[t].classList.remove(this.dotActiveClass),console.log(this.dots[t]),i==this.dots[t]&&(this.dots[t].classList.add(this.dotActiveClass),t<this.currentSlide&&(this.direction="prev",this.currentSlide=t),t>this.currentSlide&&(this.direction="next",this.currentSlide=t)),"next"!=s&&"prev"!=s||this.dots[this.currentSlide].classList.add(this.dotActiveClass);this.updateCurrentSlideSpan()}}check(){this.updateCurrentSlideSpan();let t=this.autoplaySlideTime/1e3+2;if(this.autoplay)switch(this.autoplayDirection){case"right":return this.direction="next",void this.changeSlide({y:this.currentSlide+1});case"left":return this.direction="prev",void this.changeSlide({y:this.currentSlide-1})}if(this.autoplaySlideTime<1e3){let i=String(this.autoplaySlideTime).split(""),s=parseInt(2*(i[0]+i[1]));t=this.autoplaySlideTime/s}this.checkCount++,this.checkCount>=t&&(this.autoplay=!0,this.checkCount=0)}beforeInit(){this.updateCurrentSlideSpan();(()=>{if(this.autoplay&&(this.checkAutoplay=setInterval(this.check.bind(this),this.autoplaySlideTime)),this.keysEnable&&window.addEventListener("keydown",t=>{switch(t.keyCode){case 39:this.autoplay&&(this.autoplay=!1,this.check()),this.isRunning||(this.direction="next",this.changeSlide({y:this.currentSlide+1}));break;case 37:this.autoplay&&(this.autoplay=!1,this.check()),this.isRunning||(this.direction="prev",this.changeSlide({y:this.currentSlide-1}))}}),this.arrowsEnable){const t=document.createElement("button"),i=document.createElement("button");t.classList.add(this.controlClass),i.classList.add(this.controlClass),t.classList.add(this.nextClass),i.classList.add(this.prevClass),this.sliderWrapper.after(t),this.sliderWrapper.after(i),t.style.top="45%",i.style.top="45%",t.addEventListener("click",()=>{this.autoplay&&(this.autoplay=!1,this.check()),this.isRunning||(this.direction="next",this.changeSlide({y:this.currentSlide+1}))}),i.addEventListener("click",()=>{this.autoplay&&(this.autoplay=!1,this.check()),this.isRunning||(this.direction="prev",this.changeSlide({y:this.currentSlide-1}))})}if(this.dotsEnable){const t=document.createElement("li"),i=document.createElement("ul");i.classList.add(this.dotsWrapperClass),t.classList.add(this.dotClass),this.slider.append(i),i.style.width=`${10*this.slides.length}%`,i.style.height=this.dotsHeight;for(let s=0;s<this.slides.length;s++){let e=t.cloneNode();i.append(e),this.dots=document.getElementsByClassName(this.dotClass),e.style.height=this.dotsHeight,e.style.width=this.dotsWidth,this.dots[s].addEventListener("click",t=>{this.autoplay=!1,this.isRunning||(this.check(),this.changeSlide({y:s}),this.changeDots({target:t.target}))}),this.dots[s].addEventListener("touchstart",t=>{this.autoplay=!1,this.isRunning||(this.check(),this.changeSlide({y:s}),this.changeDots({target:t.target}))})}this.dots[this.currentSlide].classList.add(this.dotActiveClass)}this.sliderWrapper.addEventListener("transitionend",()=>{if("next"==this.direction)for(let t=0;t<this.iters;t++)this.pasteSlide("append"),this.setTransition(!1),this.sliderWrapper.style.transform="translateX(0)";setTimeout(()=>{this.isRunning=!1,this.direction="",this.iters=""},0)},!1)})();for(let t=0;t<this.slides.length;t++)t<this.currentSlide&&this.pasteSlide("append");this.setTransition(!1),this.sliderWrapper.style.width=`${100*this.slides.length}%`,setTimeout(()=>{this.setTransition(!0)},1)}init(){this.checkCount=0}}document.addEventListener("DOMContentLoaded",()=>{new Slider(".slider1",{slidesToShow:1,speed:500}),new Slider(".slider2",{slidesToShow:2,speed:500}),new Slider(".autoslider",{slidesToShow:1,speed:3e3,animationType:"ease",autoplay:!0})});